<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Massage Therapy{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <nav>
        <a href="/">Home</a> |
        <a href="/about">About</a> |
        <a href="/services">Services</a>
    </nav>

    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- Floating Book Now Button -->
    <button id="bookBtn">Book Now</button>

    <!-- Modal -->
    <div id="booking-modal" class="modal">
        <div class="modal-content">
            <span id="closeBtn">&times;</span>
            <h3>Book an Appointment</h3>
            <div id="square-widget-container">
                <!-- Square widget will be dynamically injected here -->
            </div>
        </div>
    </div>

    <script>
        const bookBtn = document.getElementById("bookBtn");
        const modal = document.getElementById("booking-modal");
        const closeBtn = document.getElementById("closeBtn");
        const widgetContainer = document.getElementById("square-widget-container");

        let widgetLoaded = false;

        bookBtn.addEventListener("click", () => {
            modal.style.display = "block";

            if (!widgetLoaded) {
                const script = document.createElement("script");
                script.src = "https://square.site/appointments/buyer/widget/ixfau8kzekkohk/LFBFBWAN87BPY.js";
                script.async = true;
                widgetContainer.appendChild(script);
                widgetLoaded = true;
            }
        });

        closeBtn.addEventListener("click", () => {
            modal.style.display = "none";
        });

        window.addEventListener("click", (event) => {
            if (event.target === modal) {
                modal.style.display = "none";
            }
        });
    </script>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
